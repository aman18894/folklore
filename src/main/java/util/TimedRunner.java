package util;public class TimedRunner{    private static final long NANOS_PER_SECOND = 1000000000;    public static void run(final int repetitions, final long targetThroughput, final Iteration iteration)    {        final long timePerIteration = (NANOS_PER_SECOND) / targetThroughput;        long lastTime = System.nanoTime();        int i = repetitions;        while (i != 0)        {            final long currentTime = System.nanoTime();            final long toSend = (currentTime - lastTime) / timePerIteration;            for (long l = 0; l < toSend && i != 0; l++)            {                while (!iteration.run(i - 1))                {                    // loop to try again                }                i--;                lastTime = currentTime;            }            Thread.yield();        }    }    public interface Iteration    {        boolean run(int i);    }}